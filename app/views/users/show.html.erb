<% provide(:title, 'Perfil') %>

<div class='container'>
	<div class='row'>
		<h1>
			<%= @user.name %> <%= @user.apellido %>
			<% if (logged_in_user? && current_user.id == @user.id) %>
				<% if !@user.esPremium && !@user.user_configs.esPremium %>
					<a href="/users/id/<%=@user.id%>/s" class="btn btn-primary rounded-0 ml-3">Solicitar Premium</a>
				<% else %>
					<% if !@user.user_configs.esPremium %>
						<button class="btn btn-secondary rounded-0 ml-3" disabled>Esperando autorizacion</button>
					<% end %>
				<% end %>
			<% end %>
			<% if logged_in_admin? %>
				<% if @user.esPremium && !@user.user_configs.esPremium %>
					<a href="/users/id/<%=@user.id%>/p" class="btn btn-primary rounded-0 ml-3">Autorizar Premium</a>
				<% end %>
			<% end %>
		</h1>
		<br>
		<table class="table" style="table-layout:fixed;">
		<tr>
			<td>Numero de documento</td>
			<td>
				<% @str = '' %>
				<% @dni = @user.dni %>
				<% (1..3).each do |i| %>
					<% @mod = @dni % 1000 %>
					<% @str = (i != 3 ? ((@mod < 100 ? '0' : '') + (@mod < 10 ? '0' : '')) : '') + @mod.to_s + (i != 1 ? '.' : '') + @str %>
					<% @dni = @dni / 1000 %>
				<% end %>
				<%= @str %>
			</td>
		</tr>
		<tr>
			<td>Fecha de nacimiento</td>
			<td><%= @user.birth_date %></td>
		</tr>
		<tr>
			<td>Email</td>
			<td><%= @user.email %></td>
		</tr>
		<tr>
			<td>Numero de tarjeta</td>
			<% if logged_in_admin? %>
				<td>
					<% @str = '' %>
					<% @num = @user.numTarjeta %>
					<% (1..4).each do |i| %>
						<% @mod = @num % 10000 %>
						<% @str = (@mod < 1000 ? '0' : '') + (@mod < 100 ? '0' : '') + (@mod < 10 ? '0' : '') + @mod.to_s + (i != 1 ? '-' : '') + @str %>
						<% @num = @num / 10000 %>
					<% end %>
					<span class="badge badge-info rounded-0">
						<h6 style="display: inline-block;">
							<%= @str %>
						</h6>
					</span>
					<span class="badge badge-info rounded-0">
						<h6 style="display: inline-block;">
							<%= @user.codTarjeta %>
						</h6>
					</span>
				</td>
			<% else %>
				<td>
					<span class="badge badge-info rounded-0">
						<h6 style="display: inline-block;">
							**** **** **** <%= @user.numTarjeta % 10000 %>
						</h6>
					</span>
					<span class="badge badge-info rounded-0">
						<h6 style="display: inline-block;">
							***
						</h6>
					</span>
				</td>
			<% end %>
		</tr>
		<tr>
			<td>Premium</td>
			<td>
			<% if @user.esPremium && !@user.user_configs.esPremium %>
				<h3 style="display: inline-block;">
					<span class="badge badge-info rounded-0">●</span>
				</h3>
			<% else %>
				<% if @user.esPremium && @user.user_configs.esPremium %>
					<h3 style="display: inline-block;">
						<span class="badge badge-success rounded-0">✓</span>
					</h3> hasta el <%= @user.user_configs.fechaPremium >> 12 %>
				<% else %>
					<h3 style="display: inline-block;">
						<span class="badge badge-danger rounded-0">✗</span>
					</h3>
				<% end %>
			<% end %>
			</td>
		</tr>
		</table>
	</div>
</div>